\begin{tikzpicture}
[node distance=0.6cm and 0.6cm, thick, >=stealth, scale=0.8, every node/.style={transform shape}]

% Scenario 1 Box
% \node[draw=blue!50, fill=green!10, thick, minimum width=8cm, minimum height=5.5cm, anchor=north west] (scenario1) at (-6, 0) {};
\node[above right] at (scenario1.north west) {\textbf{Non-secure World}};

% Scenario 2 Box
\node[draw=blue!10, fill=blue!10, thick, minimum width=6cm, minimum height=5.5cm, anchor=north west] (fTPM TA) at (2.5, 0) {};
%\node[above right] at (fTPM TA) {\textbf{fTPM TA}};

%Common Bottom Box
\node[draw=blue!30, fill=blue!20, thick, minimum width=6cm, minimum height=2cm, anchor=north west] (MB2) at (9, -4.5) {MB2};

% Common Bottom Box
\node[draw=blue!30, fill=blue!20, thick, minimum width=6cm, minimum height=3.5cm, anchor= west] (EKB) at (9, -9) {EKB};

% Elements for apps
\node[draw=blue!30, block, fill=blue!20, minimum width=6cm, minimum height=0.8cm] (app1) at (-1.5, -0.9) {};
\node[draw=blue!30, fill=blue!20, block, , minimum width=6cm, minimum height=0.8cm] (app2) at (-2, -0.7) {};
\node[draw=blue!30, block, font = \footnotesize, fill=blue!20, minimum width=6cm, minimum height=0.8cm] (app3) at (-2.5, -0.5) {Applicationns};

\node[draw=blue!30, fill=blue!10, block, minimum width=7cm, minimum height=1.3cm, text width=6.8cm, align=left] (sapi) at (-2, -2.5) {\ac{SAPI}};
\node[draw=blue!30, fill=blue!20, block, minimum width=5cm, minimum height=1cm, text width=4.8cm, align=left] (blue) at (-1, -2.5) {\ac{ESAPI}};
\node[draw=blue!30, fill=blue!30, block, minimum width=3cm, minimum height=0.7cm, text width=2.8cm, align=left] (fapi) at (0, -2.5) {\ac{FAPI}};
%\node[draw=blue!30, fill=blue, block, fill=blue!30, minimum width=3cm, minimum height=0.8cm, align=center] (esapi1)  at (0, -2) {ESAPI \\(EnhancedSystem API)};
\node[draw=blue!30, fill=blue!50, block, minimum width=7cm, minimum height=0.8cm, align=center] (tcti)  at (-2, -4) {\ac{TCTI}};

% Elements for Scenario 2
\node[draw=blue, fill=blue, block, minimum width=2cm, minimum height=1.5cm, align=center] (NV) at (7, -2)  {NV Mem\\- Seeds \\ ...};
\node[draw=blue, fill=blue, block, minimum width=2cm, minimum height=1.5cm, align=center] (Volatile)  at (4, -2) {Volatile Mem\\- PCR banks,\\ ...};
%\node[draw, fill=white, block, fill=blue, minimum width=3cm, minimum height=0.8cm, align=center] (tcti2) [below=of sapi2] {\ac{TCTI}};
\node[draw=blue, fill=blue, block, minimum width=2cm, minimum height=1.5cm, align=center] (crypto2)  at (7, -4) {Crypto Library};
\node[draw=blue, fill=blue, block, minimum width=2cm, minimum height=1.5cm, align=center] (Command)  at (4, -4) {TPM \\ Command \\ Module};
%%%%%%%%%%%%%%%%%%%%%%%%%

\node[above right] at (fTPM TA.north west) {\textbf{fTPM TA}};
\node[draw=blue, fill=blue, block, minimum width=2cm, minimum height=1cm, align=center] (FUSE) at (13.5, -6) {FUSE};
\node[draw=blue, fill=blue, block, minimum width=2cm, minimum height=1cm, align=center] (fTPM Seed)  at (10.5, -6) {fTPM Seed};
%\node[draw, fill=white, block, fill=blue, minimum width=3cm, minimum height=0.8cm, align=center] (tcti2) [below=of sapi2] {\ac{TCTI}};
\node[draw=blue, fill=blue, block,  minimum width=2cm, minimum height=1cm, align=center] (Serial Number)  at (13.5, -8) {Serial Number};
\node[draw=blue, fill=blue, block,  minimum width=2cm, minimum height=1cm, align=center] (EPS Seed)  at (10.5, -8) {EPS Seed};
\node[draw=blue, fill=blue, block, minimum width=2cm, minimum height=1cm, align=center] (EK Certs)  at (10.5, -9.5) {EK Certs};
%%%%%%%%%%%%%%%%%%%%%%%%%

% Common Bottom Elements
\node[draw=blue!30, fill=blue!, block, minimum width=7cm, minimum height=0.8cm, align=center] (tab)  at (-2, -7) {TPM Access Broker};
\node[draw=blue!30, fill=blue, block, minimum width=7cm, minimum height=0.8cm, align=center] (resource) at (-2, -8) {Resource Manager};
\node[draw=blue!30, fill=blue, block, minimum width=7cm, minimum height=0.8cm, align=center] (fTPM driver) at (-2, -9.5) {fTPM driver};
\node[draw=blue!30, fill=blue, minimum width=5cm, minimum height=0.8cm, align=center] (OPTEE) at (-1, -10.5) { OPTEE driver};
% Common Bottom Elements
\node[draw=blue!50, fill=blue!30, block, minimum width=5cm, minimum height=4.5cm, text width=4.8cm, align=left] (OPTEE_OS) at (5.5, -8.5) {OP-TEE OS};
\node[draw=blue!40, fill=blue!20, block, minimum width=4cm, minimum height=2cm, text width=3.8cm, align=left] (fTPM_Helper_PTA) at (6, -7.3) {fTPM \\ Helper PTA};

\node[draw=blue!40, fill=blue, block, minimum width=2cm, minimum height=1cm] (EPS Gen)  at (7, -7) {EPS Gen};
\node[draw=blue!30, fill=blue, block, minimum width=3cm, minimum height=0.5cm] (Provisioning)  at (6.5,-8 ) {fTPM EKB};


\node[draw=blue!30, fill=blue!10, minimum width=5cm, minimum height=0.8cm, align=center] (Secure) at (5.5, -11.3) {Secure Monitor (ATF)};
\draw[dash pattern=on 5pt off 2pt] (8, -6) -- (-6,-6);
\draw[dash pattern=on 5pt off 2pt] (2,0) -- (2, -12);

% Arrows for Scenario 1
\draw[->] (OPTEE) -- (Secure);
\draw[->] (fTPM Seed) -- (EPS Gen);
\draw[->] (EPS Seed) -- (EPS Gen);
\draw[->] (EKB) -- (Provisioning);
\draw[->] (FUSE) -- (fTPM Seed);


% Arrows for Scenario 2
%\draw[<->] (app2) -- (fapi2);
%\draw[<->] (fapi2) -- (esapi2);
%\draw[<->] (esapi2) -- (sapi2);
%\draw[<->] (sapi2) -- (tcti2);
%\draw[<->] (crypto2.east) -- ++(0.8,0) |- (esapi2.west);
%\draw[<->] (marshal2.east) -- ++(0.8,0) |- (sapi2.west);

% Arrows for Common Bottom Elements
%\draw[<->] (tcti2) -- (Resource)  node[midway, below left] {\small{Network Connection}} ;
%\draw[<->] (tcti1) -- (Resource) ; 
%\draw[<->] (Resource) -- (tpmdev);
%\draw[->] (tcti2) -- (network);

\end{tikzpicture}